{% assign date_format = site.date_format | default: '%b %d, %Y' %}
{% assign site_posts = paginator.posts | default: site.posts %}
{% assign post_limit = include.limit | default: site_posts.size %}

{% assign grid_type = 'row' %}
{% if include.grid == 'col' %}
  {% assign grid_type = 'col' %}
{% endif %}

{% if include.featured == true %}
  {% assign site_posts = site_posts | where: 'featured', true %}
{% endif %}

{% if include.random == true %}
  {% assign site_posts = site_posts | sample: post_limit %}
{% endif %}

{% for post in site_posts limit: post_limit %}
  {% assign post_url = post.url | relative_url %}
  {% assign post_image = post.image.src | default: post.image | default: '/assets/img/posts/512x512.svg' %}
  {% assign image_src = post_image | relative_url %}
  {% assign image_alt = post_image.alt | default: 'Post images' %}
  <article class="post-card post-{{ grid_type }}">
    <a href="{{ post_url }}" title="{{ post.title }}">
      <img class="post-card__image" src="{{ image_src }}" alt="{{ image_alt }}" loading="lazy">
    </a>
    <div class="post-card__block">
      <h2 class="post-card__title" itemprop="headline">
        <a href="{{ post_url }}" title="{{ post.title }}">{{- post.title -}}</a>
      </h2>
      <p class="post-card__description">{%- include summary.html data=post excerpt=true short=true -%}</p>
      <div class="post-card__metadata">
        {% if post.author %}
          <span class="author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person">
              {% if post.author.name and post.author.url %}
                <a itemprop="url" href="{{ post.author.url | relative_url }}">
                  <span itemprop="name">{{ post.author.name }}</span>
                </a>
              {% else %}
                <span itemprop="name">{{ post.author }}</span>
              {% endif %}
            </span>
          </span>
        {% endif %}
        <time class="date" itemprop="datePublished" datetime="{{ post.date | date_to_xmlschema }}">
          {{- post.date | date: date_format -}}
        </time>
        {% assign a = post.content %}
        <span>{% include read-time.html words=post.content %}</span>
      </div>
    </div>
  </article>
{% endfor %}
